import*as a from"/GJ/cesiumStatic/index.js";import{D as y,p,v as I,$ as M,d as V,q as b,o as x,c as k,j as d,k as f,r as C,e as B}from"./framework.fHSmVqmP.js";import{u as A}from"./theme.wOsYQf5M.js";class o{constructor(){this.viewerMap=new Map,this.defaultViewerId="default"}static getInstance(){return o.instance||(o.instance=new o),o.instance}register(e,r){if(!e)throw new Error("必须提供有效的 Viewer 实例。");const s=r||this.defaultViewerId;if(this.viewerMap.has(s))throw new Error(`ID "${String(s)}" 已经被注册。`);return this.viewerMap.set(s,e),e}get(e=this.defaultViewerId){if(!this.viewerMap.has(e))throw new Error(`ID "${e}" 对应的 Viewer 未注册。`);return this.viewerMap.get(e)}getIdByViewer(e){for(let[r,s]of this.viewerMap)if(s===e)return r}safeGet(e=this.defaultViewerId){return this.viewerMap.get(e)}unregister(e=this.defaultViewerId){return this.viewerMap.has(e)?(this.viewerMap.get(e).destroy(),this.viewerMap.delete(e),!0):!1}getAllViewerIds(){return Array.from(this.viewerMap.keys())}getAllViewers(){return Array.from(this.viewerMap.values())}isRegistered(e=this.defaultViewerId){return this.viewerMap.has(e)}size(){return this.viewerMap.size}replace(e,r){if(!this.viewerMap.has(e))throw new Error(`Viewer with ID "${e}" does not exist.`);this.viewerMap.set(e,r)}}const w=o.getInstance(),v=y();function E(h,e){const r=p(!1);I(()=>{r.value=!0,typeof window<"u"&&typeof document<"u"&&l(e)}),M(()=>{r.value=!1,w.unregister()});function s(){w.unregister(),v.value=void 0}function l(i){v.value=w.register(u(h,i))}function u(i,c){const n=c||{shouldAnimate:!0,baseLayerPicker:!1,animation:!0,timeline:!0,infoBox:!1,selectionIndicator:!1,fullscreenButton:!1,geocoder:!1,homeButton:!1,navigationHelpButton:!1,sceneModePicker:!1,baseLayer:a.ImageryLayer.fromProviderAsync(a.TileMapServiceImageryProvider.fromUrl(a.buildModuleUrl("Assets/Textures/NaturalEarthII")),{show:!0})},t=new a.Viewer(i,n),m=t.cesiumWidget.creditContainer;m.style.display="none",t.scene.globe.enableLighting=!0,t.scene.skyBox.show=!1,t.scene.backgroundColor=a.Color.BLACK,t.scene.postProcessStages.fxaa.enabled=!0,t.imageryLayers.addImageryProvider(new a.TileCoordinatesImageryProvider),t.scene.debugShowFramesPerSecond=!0,t.scene.globe.depthTestAgainstTerrain=!1,t.clock.shouldAnimate=!0;const g=t.scene.screenSpaceCameraController;return g.zoomFactor=.95,t}return{d_viewer:v,isMounted:r,createViewer:l,destroyViewer:s}}const L=V({__name:"cesium-view",setup(h,{expose:e}){const{isMounted:r,createViewer:s,destroyViewer:l}=E("cesium-container"),u=p(),{toggle:i}=A(u);return b(()=>r.value,c=>{},{flush:"sync"}),e({createViewer:s,destroyViewer:l}),(c,n)=>(x(),k("div",{ref_key:"fullEl",ref:u,class:"relative flex flex-col"},[d("div",{class:"da-btn da-btn-circle da-btn-info da-btn-sm absolute right-0 top-0 z-10 text-xs text-emerald-950",onClick:n[0]||(n[0]=(...t)=>f(i)&&f(i)(...t))},"全屏"),n[1]||(n[1]=d("div",{id:"cesium-container",class:"w-full flex-1"},null,-1)),d("div",null,[f(r)?C(c.$slots,"default",{key:0}):B("",!0)])],512))}});export{L as _,v as d};
